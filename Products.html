<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Browse products and earn rewards through our affiliate marketplace">
  <meta name="theme-color" content="#4f46e5">
  <title>Products - Affili-at</title>
  <link rel="stylesheet" href="MyAffi.css">
  <link rel="icon" href="favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<header class="site-header">
  <div class="header-container">
    <div class="logo">
      <h1>Affili-at</h1>
    </div>
    <nav class="top-nav" role="navigation" aria-label="Main navigation">
      <a href="index.html" class="nav-link">Home</a>
      <a href="Products.html" class="nav-link active" aria-current="page">Products</a>
      <a href="ServiceFeedback.html" class="nav-link">Feedback</a>
      <a href="About.html" class="nav-link">About</a>
      <a href="Contact.html" class="nav-link">Contact</a>
    </nav>
  </div>
</header>

<main class="container">
  <section id="search-section" class="search-wrap">
    <div class="search-container">
      <input type="text" id="search-input" placeholder="Search products, brands, or categories..." 
             aria-label="Search products" autocomplete="off" />
      <button id="search-btn" class="btn btn-primary" aria-label="Search">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="11" cy="11" r="8"></circle>
          <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </button>
      <button id="back-btn" class="btn btn-outline" title="Back to previous page" aria-label="Back">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="19" y1="12" x2="5" y2="12"></line>
          <polyline points="12 19 5 12 12 5"></polyline>
        </svg>
        Back
      </button>
    </div>
    <div id="search-suggestions" class="search-suggestions" role="listbox" aria-label="Search suggestions"></div>
  </section>

  <!-- Breadcrumb navigation -->
  <nav aria-label="Breadcrumb" class="breadcrumb">
    <ol id="breadcrumb-list" class="breadcrumb-list">
      <li><a href="index.html">Home</a></li>
      <li id="breadcrumb-current">Products</li>
    </ol>
  </nav>

  <!-- Loading state -->
  <div id="loading-state" class="loading-state" aria-hidden="true">
    <div class="spinner"></div>
    <p>Loading products...</p>
  </div>

  <!-- Empty state -->
  <div id="empty-state" class="empty-state" aria-hidden="true">
    <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="8"></circle>
      <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
    </svg>
    <h3>No products found</h3>
    <p>Try adjusting your search terms or browse our categories instead.</p>
    <button id="clear-search-btn" class="btn btn-outline">Clear Search</button>
  </div>

  <!-- This same grid is used to render either subcategories OR products -->
  <div id="product-list" class="products-grid"></div>
</main>

<footer class="site-footer">
  <div class="footer-container">
    <div class="footer-logo">
      <h3>Affili-at</h3>
      <p>Your trusted affiliate marketplace</p>
    </div>
    <div class="footer-links">
      <div class="footer-column">
        <h4>Quick Links</h4>
        <a href="index.html">Home</a>
        <a href="Products.html">Products</a>
        <a href="ServiceFeedback.html">Feedback</a>
      </div>
      <div class="footer-column">
        <h4>Company</h4>
        <a href="About.html">About Us</a>
        <a href="Contact.html">Contact</a>
        <a href="#">Privacy Policy</a>
      </div>
      <div class="footer-column">
        <h4>Support</h4>
        <a href="#">Help Center</a>
        <a href="#">Terms of Service</a>
        <a href="#">Affiliate Program</a>
      </div>
    </div>
  </div>
  <div class="footer-bottom">
    <p>&copy; <span id="current-year">2025</span> Affili-at. All rights reserved.</p>
  </div>
</footer>

<script src="MyAffi.js"></script>
<script src="products.js"></script>
<script>
  // Set current year in footer
  document.getElementById('current-year').textContent = new Date().getFullYear();

  // Enhanced breadcrumb navigation
  function updateBreadcrumb() {
    const urlParams = new URLSearchParams(window.location.search);
    const category = urlParams.get("category");
    const subcategory = urlParams.get("subcategory");
    const search = urlParams.get("search");
    const type = urlParams.get("type");

    const breadcrumbList = document.getElementById('breadcrumb-list');
    if (!breadcrumbList) return;

    // Clear existing items
    breadcrumbList.innerHTML = '';
    
    // Add home
    const homeItem = document.createElement('li');
    homeItem.innerHTML = `<a href="index.html">Home</a>`;
    breadcrumbList.appendChild(homeItem);

    // Add category if present
    if (category) {
      const categoryItem = document.createElement('li');
      if (subcategory || search) {
        categoryItem.innerHTML = `<a href="Products.html?category=${encodeURIComponent(category)}&type=sub">${category}</a>`;
      } else {
        categoryItem.innerHTML = `<span>${category}</span>`;
      }
      breadcrumbList.appendChild(categoryItem);
    }

    // Add subcategory or search
    if (subcategory) {
      const subcategoryItem = document.createElement('li');
      subcategoryItem.innerHTML = `<span>${subcategory}</span>`;
      breadcrumbList.appendChild(subcategoryItem);
    } else if (search) {
      const searchItem = document.createElement('li');
      searchItem.innerHTML = `<span>Search: "${search}"</span>`;
      breadcrumbList.appendChild(searchItem);
    } else if (type === "sub" && category) {
      const subItem = document.createElement('li');
      subItem.innerHTML = `<span>Subcategories</span>`;
      breadcrumbList.appendChild(subItem);
    }
  }

  // Update breadcrumb on page load
  updateBreadcrumb();

  // Clear search button functionality
  const clearSearchBtn = document.getElementById('clear-search-btn');
  if (clearSearchBtn) {
    clearSearchBtn.addEventListener('click', () => {
      window.location.href = 'Products.html';
    });
  }

  // Add loading state management
  function showLoading() {
    const loadingState = document.getElementById('loading-state');
    const emptyState = document.getElementById('empty-state');
    const productList = document.getElementById('product-list');
    
    if (loadingState) loadingState.style.display = 'flex';
    if (emptyState) emptyState.style.display = 'none';
    if (productList) productList.style.display = 'none';
  }

  function hideLoading() {
    const loadingState = document.getElementById('loading-state');
    const productList = document.getElementById('product-list');
    
    if (loadingState) loadingState.style.display = 'none';
    if (productList) productList.style.display = 'grid';
  }

  function showEmptyState() {
    const loadingState = document.getElementById('loading-state');
    const emptyState = document.getElementById('empty-state');
    const productList = document.getElementById('product-list');
    
    if (loadingState) loadingState.style.display = 'none';
    if (emptyState) emptyState.style.display = 'flex';
    if (productList) productList.style.display = 'none';
  }

  // Expose these functions to be used by products.js
  window.loadingStates = {
    showLoading,
    hideLoading,
    showEmptyState
  };

  // Add keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    // Alt + B for back
    if (e.altKey && e.key === 'b') {
      e.preventDefault();
      document.getElementById('back-btn')?.click();
    }
    // Alt + S for search focus
    if (e.altKey && e.key === 's') {
      e.preventDefault();
      document.getElementById('search-input')?.focus();
    }
  });

  // Add page transition effect
  document.body.classList.add('loaded');
</script>
</body>
</html>
